$(function(){if($('#page.iot-applications').hasClass('landing')){if(!$.cookie('iotapps_previewed')){$('.iot-apps-intro').lightbox({buttons:{cancel:false,'try':{async:true,callback:function(event){$('.iot-apps-intro').lightbox('close');}}}}).off('lightboxclose.iot-apps-intro').on('lightboxclose.iot-apps-intro',function(){$.cookie('iotapps_previewed',1,{expires:180,path:'/'});});}}else if($('#page.iot-applications').hasClass('application')){var currentPage=0;var currentStep=0;var currentOffsets=[];var TRANSITION_DUR=300;var inputs={};var input;var board;var credentialNames={};var profileNames={};var network={};var appName=$('span.app-data').text().substr(7);var appTitle=$('#page.iot-applications.application .navigation .column-title').text();var configData=JSON.parse($('span.config-data').text());var credentialData=JSON.parse($('.credential-data').text());var profileData=JSON.parse($('.profile-data').text());var autoscrolling=false;var scrollDifference=200;var clickDifference=119;$('body').css({'margin-top':'0'})
$('#header-inner').css({'position':'fixed','background-color':'#fff','padding-top':'10px','z-index':'2'});_gaq.push(['_trackEvent',"IoT Applications","IoT Application started",appTitle]);$(window).scroll(function(){var maxHeight=$('#page.iot-applications.application').height()-250;$('#header-inner').css('top',Math.min(0,maxHeight-$(this).scrollTop()));$('#page.iot-applications.application .navigation').css('top',Math.min(120,maxHeight-$(this).scrollTop()+120));if(($('.page.selected').hasClass('scrollable')||$('.page.selected .subpage.selected').hasClass('scrollable'))&&!autoscrolling){var scroll=$(window).scrollTop();if(scroll<currentOffsets[currentStep]-scrollDifference){if(currentOffsets[currentStep-1]){currentStep--;selectStep(currentStep);}}else if(currentOffsets[currentStep+1]&&scroll>currentOffsets[currentStep+1]-scrollDifference){currentStep++;selectStep(currentStep);}}});$(document).ready(function(){$('#page.iot-applications.application .navigation ul.submenu').each(function(){$(this).css({'height':$(this).height()});$(this).hide();$('#page.iot-applications.application .navigation').css('visibility','visible');});$('#page.iot-applications.application .navigation li.menu-item.next').hide();});function showProfileControls(input,choreoIndex){var $page=input.closest('.page');var $step=input.closest('.step');var empty=false;$('.inputs-container input.choreo-input',$step).each(function(){if($(this).val()==''){empty=true;return false;}});var $profileButtons=$('.profile-buttons',$step);var $profileSelector=$('select#profile-selector',$step);var $profileSelectBox=$('a.profile-selector',$step);var $profileName=$('#profile-name',$step);var $profileCancel=$('.profile-container button.profile-cancel',$step);var choreo=$step.attr('data-choreo');var $profileConfirmSave=$('.profile-container button.profile-confirm-save',$step);if(empty){$profileButtons.hide();$profileSelectBox.show();}else{if($profileSelector.val()&&$profileSelector.val()!='Select Credential'&&$profileSelector.val()!='Select Profile'){$profileName.val($profileSelector.val());$profileConfirmSave.removeAttr('disabled');}
$profileSelectBox.hide();$profileButtons.show();if(($page.hasClass('credentials')&&credentialNames[choreo])||($page.hasClass('inputs')&&profileNames[choreo]&&profileNames[choreo][choreoIndex])){$profileCancel.show();}}
if($('.nav.next').is(':visible')){$('.next-container .callout .callout-text').text("You have unsaved changes.");$('.next-container .callout').fadeIn(TRANSITION_DUR);}}
function profile(choreo,page,choreoIndex){var choreoIndex=typeof choreoIndex=='undefined'?0:choreoIndex;var $page=$('.page[data-page="'+page+'"]');var $step=$('.step[data-choreo="'+choreo+'"]',$page).eq(choreoIndex);var $profileContainer=$('.profile-container',$step);var $profileName=$('#profile-name',$step).val('');var $profileButtons=$('.profile-buttons',$step);var $profileCancel=$('.profile-container button.profile-cancel',$step);var $profileConfirmSave=$('.profile-container button.profile-confirm-save',$step);if($page.hasClass('credentials')){updateProfileSelector(credentialData[choreo],choreo,page,choreoIndex);}else if($page.hasClass('inputs')){updateProfileSelector(profileData[choreo],choreo,page,choreoIndex);}
var $profileSelector=$('a.profile-selector',$step);$('.step').off('cut keyup paste','input.choreo-input').on('cut keyup paste','input.choreo-input',function(){showProfileControls($(this),choreoIndex);});$('.step').off('click','button.profile-cancel').on('click','button.profile-cancel',function(event){var $step=$(this).closest('.step');var $profileName=$('#profile-name',$step).val('');var $profileButtons=$('.profile-buttons',$step);var $profileSelector=$('select#profile-selector',$step);var $profileSelectBox=$('a.profile-selector',$step);var choreo=$step.attr('data-choreo');$('.callout',$profileContainer).hide();$profileName.removeClass('error');$profileButtons.hide();$profileSelectBox.show();var data;if($step.hasClass('credentials')){data=credentialData[choreo];}else if($step.hasClass('inputs')){data=profileData[choreo];}
var inputs=data[$profileSelector.val()].inputs;for(var input in inputs){var $input=$('.inputs-container input.choreo-input[name='+input+']',$step);$input.val(inputs[input]);}
if($('.nav.next').is(':visible')){checkUnsavedProfiles();}});$('.step .profile-container .profile-name').off('cut keyup paste').on('cut keyup paste',function(event){var $step=$(this).closest('.step');var $profileConfirmSave=$('.profile-container button.profile-confirm-save',$step);var userVal=$(this).val(),formattedVal=userVal;if(formattedVal.length>0){formattedVal=formattedVal.replace(/[^a-zA-Z0-9]/g,'');}
if(formattedVal!=userVal){$(this).val(formattedVal);}
if(formattedVal!=''){$profileConfirmSave.attr('disabled',false);}else{$profileConfirmSave.attr('disabled',true);}});$('.step').off('click','button.profile-confirm-save').on('click','button.profile-confirm-save',function(event){var $step=$(this).closest('.step');var $page=$(this).closest('.page');page=$page.attr('data-page');var $profileName=$('#profile-name',$step);var $profileContainer=$('.profile-container',$step);var $profileButtons=$('.profile-buttons',$step);var $profileSelector=$('a.profile-selector',$step);var choreo=$step.attr('data-choreo');var call=$step.attr('data-call');choreoIndex=call?call:0;var args={profileName:$profileName.val(),choreoUri:configData['choreos'][choreo]['uri']+'/',templateName:configData['choreos'][choreo]['templateName']};var profileInputs={};$('input.choreo-input',$step).each(function(){profileInputs[$(this).attr('name')]=$(this).val();});if($page.hasClass('credentials')){args.credentialInputs=JSON.stringify(profileInputs);args.inputs='{}';credentialNames[choreo]=$profileName.val();if(args.choreoUri=='Library/Amazon/SQS/ReceiveMessage/'){credentialNames['SendMessage']=$profileName.val();credentialNames['Publish']=$profileName.val();}
if(profileNames[choreo]&&profileNames[choreo][choreoIndex]){args.profileName=profileNames[choreo][choreoIndex];args.credentialName=credentialNames[choreo];var inputs={};$('.page.inputs .step.inputs[data-choreo='+choreo+'] input.choreo-input').each(function(){inputs[$(this).attr('name')]=$(this).val();});args.inputs=JSON.stringify(inputs);}}else if($page.hasClass('inputs')){args.credentialInputs='{}';args.inputs=JSON.stringify(profileInputs);profileNames[choreo]||(profileNames[choreo]=[]);profileNames[choreo][choreoIndex]=$profileName.val();if(credentialNames[choreo]){args.credentialName=credentialNames[choreo];var credentialInputs={};if(choreo=='SendMessage'||choreo=='Publish'){credentialInputs=credentialData['ReceiveMessage'][credentialNames['ReceiveMessage']]['inputs'];}else{credentialInputs=credentialData[choreo][credentialNames[choreo]]['inputs'];}
args.credentialInputs=JSON.stringify(credentialInputs);}}
$profileButtons.hide();$profileName.removeClass('error');$profileContainer.addClass('has-spinner');$('.callout',$step).fadeOut(TRANSITION_DUR);$.post('/choreo_proxy/profile/',args,function(response){var call=$step.attr('data-call');choreoIndex=call?call:0;$profileContainer.removeClass('has-spinner');if(response.status=='success'){$('<div class="status-alert success"></div>').append($('<p>').text('Your Profile has been saved!')).appendTo('body').fadeIn(200).delay(4000).fadeOut(200,function(){$(this).remove();});$profileButtons.hide();$('.callout',$profileContainer).hide();if($page.hasClass('credentials')){if(!credentialData[choreo]){credentialData[choreo]={};}
credentialData[choreo][credentialNames[choreo]]={inputs:profileInputs,lastModified:Date.now()}
updateProfileSelector(credentialData[choreo],choreo,page,choreoIndex,credentialNames[choreo]);updateProfileSelector(profileData[choreo],choreo,$('.page.inputs').index('.page'),choreoIndex);if(checkCredentials()){$('.nav.next').fadeIn(TRANSITION_DUR,function(){if($page.hasClass('credentials')){setTimeout(function(){$('.next-container .callout .callout-text').text("Great! Now let's build our application.");checkUnsavedProfiles();$('.next-container .callout').fadeIn(TRANSITION_DUR);},TRANSITION_DUR);}});}}else if($page.hasClass('inputs')){if(!profileData[choreo]){profileData[choreo]={};}
profileData[choreo][profileNames[choreo][choreoIndex]]={credential:credentialNames[choreo],inputs:profileInputs,credentialInputs:{},name:profileNames[choreo][choreoIndex]}
if(credentialNames[choreo]){profileData[choreo][profileNames[choreo][choreoIndex]]['credentialName']=credentialNames[choreo];profileData[choreo][profileNames[choreo][choreoIndex]]['credentialInputs']=credentialInputs;}
for(var i=0;i<profileNames[choreo].length;i++){updateProfileSelector(profileData[choreo],choreo,page,i,profileNames[choreo][i]);}
if(checkProfiles()){$('.nav.next').fadeIn(TRANSITION_DUR);checkUnsavedProfiles();}}
if($step.next('.step-arrow')){$('.step-arrow').fadeTo(TRANSITION_DUR,0).addClass('hidden');$step.next('.step-arrow').fadeTo(TRANSITION_DUR,1).removeClass('hidden');}}else{if(response.data&&response.data.errorHTML){$profileContainer.find('.profile-name-error').html(response.data.errorHTML).show();}else{$profileContainer.find('.profile-name-error').html('Something went wrong while saving your profile. Please contact <a href="/support" target="_blank">Support</a> if this persists.').show();}
$('.callout',$profileContainer).show();$profileName.addClass('error');$profileButtons.show();}},'json').error(function(){$profileContainer.find('.profile-name-error').html('Something went wrong while saving your profile. Please contact <a href="/support" target="_blank">Support</a> if this persists.').show();$('.callout',$profileContainer).show();$profileName.addClass('error');$profileButtons.show();});});$('.step .profile-container .profile-name').off('keypress').on('keypress',function(event){var $step=$(this).closest('.step');if(event.keyCode==13){$('.profile-container button.profile-confirm-save',$step).click();}});}
function updateProfileSelector(data,choreo,page,choreoIndex,selectedProfile){var $page=$('.page[data-page="'+page+'"]');var $step=$('.step[data-choreo="'+choreo+'"]',$page).eq(choreoIndex);var $profileSelector=$('#profile-selector',$step);var options=[];$profileSelector.off('change').filter('.selectBox').each(function(){$(this).selectBox('destroy').hide();});if($page.hasClass('inputs')){var selectedCredential;for(var profile in data){selectedCredential=credentialNames[choreo];if(selectedCredential&&selectedCredential!=data[profile].credential)
continue;options.push('<option data-sort="'+profile.toLowerCase()+'" value="'+profile+'" class="profile choreo-input">'+$.temboo.elide(profile,17,'middle')+'</option>');}}else if($page.hasClass('credentials')){for(var credential in data){options.push('<option data-sort="'+credential.toLowerCase()+'"value="'+credential+'" class="profile credential">'+$.temboo.elide(credential,17,'middle')+'</option>');}}
if(options.length){options.sort();if($page.hasClass('inputs')){options.unshift('<option class="option-label-only">Select Profile</option>');}else if($page.hasClass('credentials')){options.unshift('<option class="option-label-only">Select Credential</option>');}
$profileSelector.html(options.join(''));if(selectedProfile){$profileSelector.val(selectedProfile);}
$profileSelector.selectBox().on('change',function(){var $step=$(this).closest('.step');var $page=$(this).closest('.page');var choreo=$step.attr('data-choreo');var inputs=data[$(this).val()].inputs;for(var input in inputs){var $input=$('.inputs-container input.choreo-input[name='+input+']',$step);$input.val(inputs[input]);}
if($page.hasClass('credentials')){credentialNames[choreo]=$(this).val();if(choreo=='ReceiveMessage'){credentialNames['SendMessage']=$(this).val();credentialNames['Publish']=$(this).val();}
updateProfileSelector(profileData[choreo],choreo,$('.page.inputs').index('.page'),choreoIndex);if(checkCredentials()){$('.nav.next').fadeIn(TRANSITION_DUR);setTimeout(function(){$('.next-container .callout .callout-text').text("Great! Now let's build our application.");checkUnsavedProfiles();$('.next-container .callout').fadeIn(TRANSITION_DUR);},TRANSITION_DUR);}}else if($page.hasClass('inputs')){profileNames[choreo]||(profileNames[choreo]=[]);profileNames[choreo][choreoIndex]=$(this).val();if(checkProfiles()){$('.nav.next').fadeIn(TRANSITION_DUR);checkUnsavedProfiles();}}
if($step.next('.step-arrow')){$('.step-arrow').fadeTo(TRANSITION_DUR,0).addClass('hidden');$step.next('.step-arrow').fadeTo(TRANSITION_DUR,1).removeClass('hidden');}});$('a.profile-selector',$step).show();}else{$('a.profile-selector',$step).hide();}
$('.profile-container .callout').hide();}
function checkCredentials(){for(choreo in configData.choreos){if(configData['choreos'][choreo]['credentialInputs']&&!credentialNames[choreo]){return false;}}
return true;}
function checkProfiles(){for(choreo in configData.choreos){if(configData['choreos'][choreo]['inputs']){for(var i=0;i<configData['choreos'][choreo]['inputs'].length;i++){if(!(profileNames[choreo]&&profileNames[choreo][i]))
return false;}}}
return true;}
function checkBoard(){if(!board){return false;}
if(board=='ti_cc3200'&&(!network['ssid']||!network['password'])){return false;}
return true;}
function checkUnsavedProfiles(){var $page=$('.page[data-page="'+currentPage+'"]');if($('.profile-buttons',$page).is(':visible')){$('.next-container .callout .callout-text').text("You have unsaved changes.");$('.next-container .callout').fadeIn(TRANSITION_DUR);}else{$('.next-container .callout').fadeOut(TRANSITION_DUR);}}
function loadPage(page){if($('.navigation .menu li.selected .submenu').length>0){$('.navigation .menu li.selected .submenu').slideUp(TRANSITION_DUR,function(){$('.navigation .menu li.selected').removeClass('selected');});}else{$('.navigation .menu li.selected').removeClass('selected');}
$('.page[data-page="'+currentPage+'"]').removeClass('selected');$('.page[data-page="'+currentPage+'"]').fadeOut(TRANSITION_DUR,function(){currentPage=page;currentStep=0;$('.page[data-page="'+currentPage+'"]').addClass('selected');if($('.disabled-popup.cta').length>0){if(!$('.page[data-page="'+currentPage+'"]').hasClass('video')){$('.page[data-page="'+currentPage+'"]').addClass('disabled');$('input',$('.page[data-page="'+currentPage+'"]')).attr('disabled','disabled');$('.navigation').addClass('disabled');$('.nav.next').addClass('disabled');$('.disabled-popup').hide();$('.disabled-popup.cta').show();}
$('.disabled-popup.cta').off('click','button.close').on('click','button.close',function(){$('.navigation').removeClass('disabled');$('.nav.next').removeClass('disabled');$('.disabled-popup.cta').hide();loadPage(0);})}
if($('.page.selected').hasClass('subpages')){$('.subpage','.page.selected').hide();$('.subpage:first','.page.selected').show();}
$('.page.selected').fadeIn(TRANSITION_DUR,function(){oauthWizard($('.page.selected .step.oauth-wizard'),configData.oauthWizard);if($('.page.selected').hasClass('scrollable')){currentOffsets=[];$('.page.selected .step.box').each(function(){currentOffsets[$(this).attr('data-step')]=$(this).offset().top;});}});$('html, body').animate({scrollTop:0},TRANSITION_DUR);$('.navigation .menu li[data-page="'+currentPage+'"]').addClass('selected');$('.navigation .menu li.selected .submenu-item').removeClass('selected');selectStep(currentStep);if($('.page[data-page="'+currentPage+'"]').hasClass('next')||$('.page[data-page="'+currentPage+'"]').hasClass('download')||$('.page[data-page="'+currentPage+'"]').hasClass('credentials')||$('.page[data-page="'+currentPage+'"]').hasClass('inputs')||$('.page.selected').hasClass('subpages')){if(($('.page[data-page="'+currentPage+'"]').hasClass('credentials')&&checkCredentials())||($('.page[data-page="'+currentPage+'"]').hasClass('inputs')&&checkProfiles())){$('.nav.next').show();}else{$('.nav.next').hide();}}else{$('.nav.next').show();}
if($('.page[data-page="'+currentPage+'"]').hasClass('hardware')){$('.page.hardware .subpage.hardware-instructions').removeClass('selected');$('.page.hardware .subpage.board-options').addClass('selected');}else if($('.page[data-page="'+currentPage+'"]').hasClass('download')){if($('.disabled-popup.signup-cta').length>0){$('.page.download .disabled-popup').hide();}else{if(!checkCredentials()){$('.page.download .disabled-popup .disabled-steps li.credential').show();}else{$('.page.download .disabled-popup .disabled-steps li.credential').hide();}
if(!checkProfiles()){$('.page.download .disabled-popup .disabled-steps li.profile').show();}else{$('.page.download .disabled-popup .disabled-steps li.profile').hide();}
if(!checkBoard()){$('.page.download .disabled-popup .disabled-steps li.board').show();}else{$('.page.download .disabled-popup .disabled-steps li.board').hide();}
if($('.page.download .disabled-popup .disabled-steps li:visible').length>0){$('.page.download').addClass('disabled');}else{$('.page.download').removeClass('disabled');$('.navigation .menu li.menu-item.next').slideDown(TRANSITION_DUR);$('.nav.next').show();}}}
if($('.page[data-page="'+currentPage+'"]').hasClass('next')){$('.page.next .step').hide();$('.page.next .next-landing').show();}
$('.navigation .menu li.selected .submenu').slideDown({duration:TRANSITION_DUR});$('.page.next').css('min-height',$('.navigation').height());$('.next-container .callout').hide();$('.step-arrow').off('click').on('click',function(e){var next=$(this).next('.step').data('step');if(next&&!$(this).hasClass('hidden')){goToStep(next);}});});}
function goToStep(step){var $page=$('.page[data-page="'+currentPage+'"]');$('.step-arrow').fadeTo(TRANSITION_DUR,0).addClass('hidden');currentStep=step;if($page.hasClass('subpages')){if(!$('.step[data-step='+currentStep+']',$page).parent().hasClass('selected')){$('.subpage.selected',$page).removeClass('selected').fadeOut(TRANSITION_DUR,function(){$('.step[data-step='+currentStep+']',$page).parent().addClass('selected');if($('.subpage.selected',$page).hasClass('hardware-instructions')){if(board){$('.subpage.hardware-instructions').removeClass('disabled');}else{$('.subpage.hardware-instructions').addClass('disabled');}}
$('.subpage.selected',$page).fadeIn(TRANSITION_DUR,function(){selectStep(step);if($('.subpage.selected',$page).hasClass('scrollable')){currentOffsets=[];$('.subpage.selected .step',$page).each(function(){currentOffsets[$(this).attr('data-step')]=$(this).offset().top;});$('html, body').animate({scrollTop:currentOffsets[step]-clickDifference},TRANSITION_DUR);}
if($('.subpage.selected',$page).is(':last-child')){$('.nav.next').show();}else{$('.nav.next').hide();}
if($('.subpage.selected',$page).hasClass('hardware-instructions')){}});$('html, body').animate({scrollTop:0},TRANSITION_DUR);});}}
if($page.hasClass('scrollable')||$('.subpage.selected',$page).hasClass('scrollable')){autoscrolling=true;$('html, body').animate({scrollTop:currentOffsets[step]-clickDifference},TRANSITION_DUR,function(){if(autoscrolling){selectStep(step);}
if($('.step.selected input.profile-name').is(':visible')){$('.step.selected input.profile-name').focus();}
autoscrolling=false;});}}
function selectStep(step){$('.navigation .menu li.selected .submenu-item.selected').removeClass('selected');$('.step-arrow').fadeTo(TRANSITION_DUR,0).addClass('hidden');$('.navigation .menu li.selected .submenu-item[data-step='+currentStep+']').addClass('selected');var $step=$('.page.selected .step[data-step='+currentStep+']');if($('.page.selected').hasClass('hardware')){$('.step.selected .text-no-box').fadeTo(TRANSITION_DUR,0);}
$('.page.selected .step.selected').removeClass('selected');$step.addClass('selected');if(!$step.hasClass('inputs')&&!$step.hasClass('credentials')&&$step.next('.step-arrow')&&$step.next('.step-arrow').css('opacity')==0){setTimeout(function(){$step.next('.step-arrow').fadeTo(TRANSITION_DUR,1).removeClass('hidden');},TRANSITION_DUR);}
if($('.page.selected').hasClass('hardware')){$('.text-no-box',$step).fadeTo(TRANSITION_DUR,1);}
if($('.callout',$step).not('.profile-buttons .callout').length>0&&!$('.page.selected').hasClass('disabled')){setTimeout(function(){$('.callout',$step).not('.profile-buttons .callout').fadeIn(TRANSITION_DUR);},TRANSITION_DUR);}
if($('input.choreo-input',$step).length>0){if(!(window.navigator.userAgent.indexOf('MSIE ')>-1||window.navigator.userAgent.indexOf('Trident/')>-1)){var x=window.scrollX,y=window.scrollY;}
$('input.choreo-input:first',$step).focus();if(!(window.navigator.userAgent.indexOf('MSIE ')>-1||window.navigator.userAgent.indexOf('Trident/')>-1)){window.scrollTo(x,y);}}}
$('.column-inner').off('click','.nav.next').on('click','.nav.next',function(){loadPage(currentPage+1);});$('.navigation').off('click','li.menu-item .menu-link').on('click','li.menu-item .menu-link',function(){loadPage(parseInt($(this).parent().attr('data-page')));});$('.navigation').off('click','li.submenu-item').on('click','li.submenu-item',function(){if($(this).parent('a').length==0){goToStep($(this).attr('data-step'));}});$('.page.hardware .subpage.hardware-instructions').prepend('<div class="disabled-popup">\
			<div class="disabled-title">Oops! We didn\'t catch what board you\'re working with.</div>\
			<div class="disabled-subtitle"><a rel="select-board">Select a board</a> and we\'ll show you how to get connected.</div>\
		</div>');$('.page.hardware').off('click','.board-options a').on('click','.board-options a',function(){board=$(this).attr('rel');if(board=='ti_cc3200'){$('.credential-editor').lightbox({buttons:{'save':{async:true,callback:function(event){var ssid=$('.credential-editor .device-network-form input[name=ssid]').val();var password=$('.credential-editor .device-network-form input[name=password]').val();network['ssid']=ssid;network['password']=password;$('.credential-editor').lightbox('close');showHardwareInstructions(board);}}}});$('.credential-editor input').off('cut keyup paste').on('cut keyup paste',function(event){var $credentialSave=$('.credential-editor button.save');if($('.credential-editor .device-network-form input[name=ssid]').val()!=''&&$('.credential-editor .device-network-form input[name=password]').val()!=''){$credentialSave.removeAttr('disabled');}else{$credentialSave.attr('disabled','disabled');}
if(event.keyCode==13){$('.credential-editor button.save').click();}});}else{showHardwareInstructions(board);}});function showHardwareInstructions(board){var boardName;var platform;var platformName;var shortPlatformName;var link;if(board=='samsung_artik_ten'){boardName='Samsung ARTIK 10';platform='samsung';platformName='Samsung ARTIK';shortPlatformName='ARTIK';link='/hardware/samsung';}else if(board=='arduinoyun'){boardName='Arduino YÃºn';platform='arduino';platformName='Arduino';shortPlatformName='Arduino';link='/arduino/yun';}else if(board=='ti_cc3200'){boardName='TI CC3200 LaunchPad';platform='ti';platformName='TI LaunchPad';shortPlatformName='TI';link='/hardware/ti';}
_gaq.push(['_trackEvent',"IoT Applications","Selected board",boardName]);$('.page.next .next-landing .tutorial-container').html('<a href="'+link+'" target="_blank" class="tutorial-link">\
					<div class="box tutorial">\
						<div class="column left">\
							<div class="tutorial-header">Tutorials & Resources</div>\
							<div class="tutorial-description">\
								See what else your '+platformName+' can do with Temboo in these tutorials.\
							</div>\
						</div>\
						<div class="column right tutorial-image '+platform+'"></div>\
					</div>\
				</a>');$('.navigation .menu-item .submenu a.tutorial-link').attr('href',link);$('.navigation .menu-item .submenu a.tutorial-link li.submenu-item').text("Temboo's "+shortPlatformName+" tutorials");$('.page.download .board-instructions .help-header').text('Need help running the '+platformName+' code?');$('.page.download .board-instructions .help-slider').empty();$('.page.download .board-instructions .help-slider').append($('.help-instructions.'+platform));$('.page.download .board-instructions .help-slider .help-instructions.'+platform).show();$('.page.hardware').attr('rel',board);$('.page.hardware .pin span').hide();$('.page.hardware .pin span[rel='+board+']').show();goToStep(1);}
$.each(configData.choreos,function(choreo,meta){var breadcrumbs=meta['uri'].split('/');breadcrumbs.shift();var credentialTitle='';for(var i=0;i<breadcrumbs.length-2;i++){credentialTitle+=breadcrumbs[i]+' . ';}
var inputsTitle=credentialTitle;credentialTitle+='<strong>'+breadcrumbs[i]+'</strong>';inputsTitle+=breadcrumbs[i]+' . '+'<strong>'+breadcrumbs[i+1]+'</strong>';if(meta['uri']=='Library/Amazon/SQS/ReceiveMessage'){credentialTitle='Amazon . <strong>AWS</strong>';}
var $profileContainer='<div class="profile-container">\
				<select id="profile-selector" class="profile-selector"></select>\
				<span class="profile-buttons">\
					<div class="callout">\
			            <span class="callout-error-text profile-name-error"></span>\
			            <div class="triangle-with-shadow right"></div>\
			        </div>\
					<input type="text" id="profile-name" class="profile-name anchor" placeholder="Name your Profile">\
					<button class="button small white profile-cancel">Cancel</button>\
					<button class="button small profile-confirm-save" disabled="disabled">Save</button>\
				</span>\
				<div class="spinner right"></div>\
			</div>';if(meta['credentialInputs']){var $credentialStep=$('.step.box.credentials[data-choreo="'+choreo+'"]');$credentialStep.append('<p class="choreo-name">'+credentialTitle+'</p>');$credentialStep.append('<p class="choreo-description">'+meta['credentialDescription']+'</p>');$credentialStep.append('<div class="inputs-container">\
						<div class="credential-container">\
							<div class="subtitle">API Credentials</div>\
							<div class="credential-inputs"></div>\
						</div>\
					</div>');$('.credential-container',$credentialStep).append($profileContainer);profile(choreo,$('.page.credentials').index('.page'));for(var i=0;i<meta['credentialInputs'].length;i++){input='<div class="input">';input+='<div class="type-icon type-'+meta['credentialInputs'][i]['type']+'"></div>';input+='<span class="name">'+meta['credentialInputs'][i]['name']+'</span>';input+='<div class="description">'+meta['credentialInputs'][i]['description']+'</div>';input+='<div class="callout-container">';if(meta['credentialInputs'][i]['text']){input+='<div class="input-text">'+meta['credentialInputs'][i]['text']+'</div>';}else{input+='<input class="choreo-input"\
				            type="'+((meta['credentialInputs'][i]['type']=='password')?"password":"text")+'"\
				            autocomplete="off" \
				            name="'+meta['credentialInputs'][i]['name']+'"\
				            placeholder="'+(meta['credentialInputs'][i]['placeholder']?meta['credentialInputs'][i]['placeholder']:'')+'">';}
if(meta['credentialInputs'][i]['callout']){input+='<div class="callout input">\
			                <span>'+meta['credentialInputs'][i]['callout']+'</span>\
			                <div class="triangle-with-shadow left"></div>\
			            </div>';}
input+='</div></div>';$('.step.box.credentials[data-choreo="'+choreo+'"] .credential-inputs').append(input);}}
if(meta['inputs']){var inputs;for(var call=0;call<meta['inputs'].length;call++){var $inputStep=$('.step.box.inputs[data-choreo="'+choreo+'"]').eq(call);$inputStep.attr('data-call',call);inputs=meta['inputs'][call];$inputStep.append('<p class="choreo-name">'+inputsTitle+'</p>');$inputStep.append('<p class="choreo-description">'+meta['description']+'</p>');$inputStep.append('<div class="inputs-container">\
							<div class="subtitle">Variables</div>\
							<div class="choreo-inputs"></div>\
						</div>');$('.inputs-container',$inputStep).append($profileContainer);profile(choreo,parseInt($('.page.inputs').attr('data-page')),call);for(var i=0;i<inputs.length;i++){input='<div class="input">';input+='<div class="type-icon type-'+inputs[i]['type']+'"></div>';input+='<span class="name">'+inputs[i]['name']+'</span>';input+='<div class="description">'+inputs[i]['description']+'</div>';input+='<div class="callout-container">';if(inputs[i]['text']){input+='<div class="input-text">'+inputs[i]['text']+'</div>';}else{input+='<input class="choreo-input"\
					            type="text"\
					            autocomplete="off" \
					            name="'+inputs[i]['name']+'"\
					            placeholder="'+(inputs[i]['placeholder']?inputs[i]['placeholder']:'')+'">';}
if(inputs[i]['callout']){input+='<div class="callout input">\
				            	<span>'+inputs[i]['callout']+'</span>\
				            	<div class="triangle-with-shadow left"></div>\
				            </div>';}
input+='</div></div>';$('.choreo-inputs',$inputStep).append(input);}}}});$('.page.hardware').off('click','a[rel="select-board"]').on('click','a[rel="select-board"]',function(){goToStep(0);});$('.page.download').prepend('<div class="disabled-popup">\
			<div class="disabled-title">Your code is just a few steps away!</div>\
			<div class="disabled-subtitle">...but first:</div>\
			<ol class="disabled-steps">\
				<li class="credential">Save Credential inputs</li>\
				<li class="profile">Save Profile inputs</li>\
				<li class="board">Select a board</li>\
			</ol>\
		</div>');if($('.page.download .ios-instructions').length>0){$('.page.download .ios-instructions .help-slider').append($('.help-instructions.ios'));$('.page.download .ios-instructions .help-slider .help-instructions.ios').show();}
$('.page.download .download-container').html('<div class="end-column left">\
			<div class="end-icon"></div>\
				<form class="download-form" action="/iot-applications/'+appName+'/download/" method="POST">\
				    <button type="submit" class="button large icon right download-app">Download</button>\
				</form>\
			</div>\
			<div class="end-column right">\
				<div class="end-text">\
					That\'s all there is to it!<br/>\
					Your code is ready to go.</div>\
		</div>');$('.page.download').off('click','button.download-app').on('click','button.download-app',function(event){event.preventDefault();var $form=$('.page.download form.download-form');$('input[name!="'+TEMBOO_CSRF_NAME+'"]',$form).remove();$form.append('<input type="hidden" name="board" value="'+board+'" />');$.each(profileNames,function(choreoName,profileList){$.each(profileList,function(n,value){$form.append('<input type="hidden" name="profiles['+choreoName+'][]" value="'+value+'" />');});});if(network['ssid']&&network['password']){$.each(network,function(name,value){$form.append('<input type="hidden" name="network['+name+']" value="'+value+'" />');});}
$form.submit();var $downloadIcon=$('.page.download .end-icon');$downloadIcon.removeClass('wave1 wave2 wave3');setTimeout(function(){$downloadIcon.addClass('wave1');setTimeout(function(){$downloadIcon.removeClass('wave1').addClass('wave2');setTimeout(function(){$downloadIcon.removeClass('wave2').addClass('wave3');},333);},333);},333);_gaq.push(['_trackEvent',"IoT Applications","Downloaded application",appTitle]);});$('.page.download').off('click','.help-header').on('click','.help-header',function(){$helpContainer=$(this).parent();if($(this).hasClass('open')){$('.help-slider',$helpContainer).slideUp(TRANSITION_DUR,function(){$('.help-header',$helpContainer).removeClass('open');});}else{$(this).addClass('open');$('.help-slider',$helpContainer).slideDown(TRANSITION_DUR);}});$('.page.next .next-landing').append('<div class="tutorial-container"></div>');}
function oauthWizard($step,wizardConfig){if(!$step||!$step.length||$step.hasClass('oauth-wizard-loaded')){return false;}
$step.addClass('oauth-wizard').addClass('oauth-wizard-loaded');$step.append('<p class="title">'+wizardConfig.title+'</p><p class="title-small">'+wizardConfig.subtitle+'</p>');var wizardTimer;var $content=$('<div></div>').appendTo($step);var $wizardSteps=$('<div class="wizard-steps"></div>').appendTo($step);var segmentWidth=Math.floor($wizardSteps.width()/(wizardConfig.steps.length-1));var segments=[]
$(wizardConfig.steps).each(function(i){var step=this;var $segment=$('<div class="wizard-step-segment" style="width: '+(segmentWidth*i)+'px;"></div>').appendTo($wizardSteps);segments[i]=$segment;var $dot=$('<div class="wizard-step-dot"><span>'+step.title+'</span></div>').appendTo($segment);var $next=$('<a class="button small next">Next</a>').appendTo($dot);$next.on('click',function(e){e.preventDefault();e.stopPropagation();$dot.trigger('click');});$dot.on('click',function(e){e.preventDefault();if(!$segment.hasClass('enabled')){return false;}
window.clearInterval(wizardTimer);var $nextSegment=$();$(segments).each(function(j){$(this).removeClass('current').removeClass('enabled').removeClass('next');if(j<=i+1){$(this).addClass('enabled');}
if(j==i+1){$nextSegment=$(this).addClass('next');}});$segment.addClass('current');$content.html(step.description);if(step.inputs&&step.inputs.length){var required=[];$(step.inputs).each(function(){var stepInput=this;if(step.authorization&&stepInput['name']=='AuthorizationURL'){stepInput['text']='<div class="oauth-spinner"></div>';}
var input='<div class="input">';if(this['text']){input+='<span class="name">'+this['name']+'</span>';input+='<div class="callout-container">';input+='<div class="input-text">'+this['text']+'</div>';if(this['value']){input+='<input class="choreo-input"\
						            type="hidden"\
						            autocomplete="off" \
						            name="'+this['name']+'"\
						            value="'+this['value']+'">';}}else if(this['type']=='hidden'){input+='<input class="choreo-input"\
						            type="hidden"\
						            autocomplete="off" \
						            name="'+this['name']+'"\
						            value="'+this['value']+'">';}else{input+='<span class="name">'+this['name']+'</span>';input+='<input class="choreo-input"\
					            type="'+((this['type']=='password')?"password":"text")+'"\
					            autocomplete="off" \
					            name="'+this['name']+'"\
					            placeholder="'+(this['placeholder']?this['placeholder']:'')+'">';}
if(this['callout']){input+='<div class="callout input">\
				                <span>'+this['callout']+'</span>\
				                <div class="triangle-with-shadow left"></div>\
				            </div>';}
input+='</div></div>';$inputWrapper=$(input).appendTo($content);if(!this.text){$input=$inputWrapper.find('input');required.push($input);if(stepInput.value){$input.val(stepInput.value);}
if(!this.fromOutput){$input.on('cut keyup paste',function(e){stepInput.value=$(this).val();var filled=true;$(required).each(function(){if(!$(this).val()){filled=false;}});if(filled){$nextSegment.addClass('enabled').addClass('next');}else{$nextSegment.removeClass('enabled').removeClass('next');}});}}});if(required.length){required[0].trigger('paste');}
if(step.authorization){$nextSegment.removeClass('enabled').removeClass('next');var args={'bundle':wizardConfig.oauthBundle,'inputs':{}};$(wizardConfig.steps[i-1].inputs).each(function(){args.inputs[this.name]=this.value;});$.post('/iot-applications/initializeOAuth',args,function(response){if(response.success&&response.outputs.AuthorizationURL){var $spinnerParent=$('.oauth-spinner',$content).parent();$spinnerParent.text(response.outputs.AuthorizationURL);$content.append('<p class="right-align"><a href="'+response.outputs.AuthorizationURL+'" class="button large" target="_blank">Launch Authorization</a></p>');wizardTimer=window.setInterval(function(){if($.cookie(response.cookie)){window.clearInterval(wizardTimer);$.cookie(response.cookie,null,{secure:true,path:'/'});args.inputs=response.inputs;for(var k in response.outputs){args.inputs[k]=response.outputs[k];}
$.post('/iot-applications/finalizeOAuth',args,function(response){if(response.success){$(wizardConfig.steps[i+1].inputs).each(function(){if(this.fromOutput){if(response.outputs[this.name]){this.value=response.outputs[this.name];}else if(response.inputs[this.name]){this.value=response.inputs[this.name];}}});$nextSegment.addClass('enabled').addClass('next').find('.wizard-step-dot').trigger('click');var $next=$('<a class="button small use">Use</a>').appendTo($('.wizard-step-segment.current .wizard-step-dot'));$next.show();$next.on('click',function(e){var $oauthStep=$('.step[data-step='+currentStep+']');var $credentialStep=$('.step[data-step='+(parseInt(currentStep)+1)+']');goToStep(parseInt(currentStep)+1);$('input.choreo-input',$credentialStep).each(function(){var $input=$(this);$input.val($('input.choreo-input[name='+$input.attr('name')+']').val());});showProfileControls($('input.choreo-input',$credentialStep).first());});}else if(response.error&&response.message){$spinnerParent.text(response.message);}else{$spinnerParent.text('OAuth failed!');}});}},500);}else if(response.error&&response.message){$spinnerParent.text(response.message);}else{$spinnerParent.text('OAuth failed!');}});}}});});segments[0].addClass('enabled').addClass('current').find('.wizard-step-dot').trigger('click');}
var choreo=0;$('#page.iot-applications.create #add-choreo').off('click').on('click',function(e){e.preventDefault();$('#choreos').append('<span class="label">URI:</span><input class="choreo" type="text" name="choreos['+choreo+']" placeholder="e.g. Library/Yahoo/Weather/GetWeatherByAddress/" />').append('<button class="add-input" data-choreo='+choreo+'>+ Add Input</button>').wrapInner('<div class="choreo-container" />');choreo+=1;});$('#page.iot-applications.create #choreos').on('click','button.add-input',function(e){e.preventDefault();var whichChoreo=$(this).data('choreo');var $inputContainer=$('<div class="input-container" />').append('<span class="label">Input Name:</span><input type="text" name="inputs['+whichChoreo+'][]" placeholder="e.g. Address" />').append('<span class="label">Placeholder:</span><input type="text" name="placeholders['+whichChoreo+'][]" />').append('<span class="label">Callout:</span><input type="text" name="callouts['+whichChoreo+'][]" />')
$(this).before($inputContainer);});});